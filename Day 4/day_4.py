mainTestCase = """
MASAMXMSSXXMAMXXMXMASXMASXMMSMSMMMAXMASASMMSSMSXAXMASMMSMMMSSMSASMSSSSMSMSMXXMXMAXAMXMSMSSXSAMXMSSXSXSXMASXMSASXMMXSXMSSSSSXSAMMAMXSXXMAAXSA
MASMMXMASAXASMSMMMSAMXSMSAMXAAAAAXAMXASXAMAAAAMMSMMMMMASXAAAAMMAMAMMASAAAAXMXMSSSSSSMMSAMAXAXXSMAMSAMXASAXXASAMXASAMAXXMASAAAMAMAXXMASXSXSXS
MMXAXMMMSXMAMAAXAAXAAAXXSMMSMSMSMXAXMXSMMMMSSMXAMXAAXMAMMMMSSMMAMAMMAMMMMMXSAAXAAMMAXXSAMXMSMAXMAMSMSSXMASMMMSXSXMAXMMSMMMMMMSASMSXMAMAXXSAM
SXSAMASASMSXMSMSMSSMMMMMMXAMXMMXMASMMMMAXXAAAMMMSSSSSMASXXAAXASMSXXMXSXSXSASMSMMSMSAMMMAMXAAMASXMMSXMXMMMXASAXMSAASAMXSAAMXSXMASAXMMXSMSMMAM
AAAXXXMASASXMXMAXXMMASAASMXSASASXAAAAMSSMMMSXMAAMMMMMXAXMMMMSAMXAMASAMXSAMASXXAXAAMAMXSAMXSXSMMASAMSMASAAMSMMSSXMAXASASMMSAMASAMAMSMAAXMASXM
MSMMXXMMMAMAMMMMMMXSAXXAMMMMXSAXMMXXAMXAAMMXMASXMAAASMMXAAMXAXAMMMAMAMAMAMXMASXMMXMAAXMAXMAMXMSAMASXMAXMSXMAMXXXMASAMAMAXMMMAAXXAAAMXSXMMMAS
MXAXAMXXMMMMSAMAASMMMSMMASASAMAMAXMSXMSMMXAMXAXMMSSXSASXSSSMAMSMXMXSAMSSSMAMXMXAMAXXMMSAXAXMMXMASMMMMSSMMASAMMAMSMMAMAXSMXXMSSSSSSMXAXMSSMMM
ASXMMXSAMXAASXXMXSAAAXASAMMMASMSSSMAAMMXMMSSMASAMAMMMAMMAXMAXMASXMAXMSAAASASAMXSSMXSAAXSSMXAAXXAXMAMXMAMSMMAXMAAAAMXMAMXASXAMAMXMXMMAXAAXAXS
MAASMAMMSSMMSMSSXSMMXSMMASMSXMAAASMMMMAAMAMAMXAXAASMSSMMMMXSMSXSMXSXMXMXMSXMASAMAAAMMMMMMXXXSXMASMXMXMMMSXMSAMASMSMAXMASAAMXMMSSMASXXMXMAXMA
SAMXMXSAXAMASMXAASXSMMAXXMASAMMMMMMXXXSXMASAMXMASXSAAMXXXMMXMXAXMAMAMXXAAMAXAMASMMMSMMXSMMMXMAAMXXAXSXSASASXSMAMAAXMMSMMXMAXSAAAMXSASMSSXSAS
MMXSSXMXSAMASXXMXMAXAXXMSMMMXSAMXXMSXMMASXSXSXXAXMMMMMXMAXAMXMMMMASAMXSMSSSMSMMMMMAXXMAXAAAAXXSXXSASXAMAXXMAXMAMSMMSASXMAXMXMMSXSAMXMAAXASAM
ASAMXAMXSXMAMMMXAMSSSMSAXXXMSXASASXXAASAMXMAMAMSXXAXASASASXXSAAAMASAMAXXAAAMXASXSMXXAMASMMSMSAMAMXXXMMMSMXMMMXMXAAAMXSASXSSSXAAAMMAMMMMMAMAM
MMMSSXMXMAMXMSMXMSAAAAMMMXMSMSMMAAMSSMXAMMMAMXMXXSXSMSAMXSMAMSXSXAXAMSMMMSMMSAMAXAMXXAXXXAAAMXXMMSMMMSAMXXSASASXSMMXMSAMAAAAMMSXMAAMAMAMXMAM
XXAXMASMSAMAAAAASMMMMXMASMMAAAXMAMAAMMMSAMSAMSAXMAAMMMAMXMMMMAXXAMXSMMSMAXXXXAMSMMSASMMMMSMXMSMMAAAAAMMMXMMAMASAMAAAXMSMMMMMXXMASXSSSSXSASAS
SASAMXMAMMSASMSMXASMMASXSASMSSXSAMMXAAAASASAMXMXAXMSASASMXAAMMSMMSAMXAAMASMMSMMXAXMXXAAXXAAASAAMSSSMSXMXSAMAMAMASMSMSAMXMMASMMXMMAAAAXASMSSM
XAMASXSXSASAXMXMSXMASAXASMSAAXXMAMSSSMSAXMMMSAMXMSASASAMAMMMSAAMAMASMSXSAXAMAMXMXMASXSMMSXSXMAXMAAXAMASXMAMXSXMXMXAXMAMAMAAAXMSXMMMMMMXMXXXM
MMMASMAAMMMAMASASAMXMASMMAMMMMMXMMXAMAMXMAAXMAXXXMAMXMMMSSMAMMXMXSXMAXMMMSSSXSMSAMXSAXMASMMMASXMXSXXXAMAXAMMSASMSSSMSASASMXSAMAMXXAASXMMSASX
AXMAXXMXMXSAMMMAMAMXMXAMXSMSXASASMMAMXMSSXMSXSAMXMXMMXSXAAXMASXMXAMSXSAAXXAXXXAAXAAMMMXXMAMMAMAAAMMSMSSMMSSMSAMAAAAASASASAMXXAXMMSAXSAAXMASX
SXMASXXXMAXASMMMMMSXMMASXAAXSXSXSASMMASMSAXMAXAMXXMAMASMSSMMAXAAASASASMMAAMMXMSMSMXSAMXMXSXMASMMMSAXMMAXSMAMMXMMMSMMMAMAMXMAMXMAMAMMSXMXMXMX
MAMMAMXAMXSSMMXAAXAMASAMXMMASXSXSAMMSMSAXMASASAMMMAAMAXAMXXMMSMMAASMAMMXMMXSAAAAXMASASMMAMXXMAAAXMXSSMXMAXAMXAMSMMMSMSMSMAMMSAXMASAAXMMASAAX
SAXSAXSXSXMMASMSSMXMMMASXXAAMMMAMAMAAMMMMAMMMMAMAASXMSSSXMAXMAXAXMXMSMAXXAASMMMSMXMSAMXMASMSSSSMMSAXMASAMSMSXMMAAAAAXAAXSAMMMMXXXMMXSMSASMSM
MAMAXMMMXAASAMAMMMMMSSMSXSMXSAMSMMMSXSASAAXAAMAMSMMAMAAMAMXMSASXSXXXXAMXMMXSMSMXMAMMAMXSASAAXAAAXMAMSAMAXAMSASMSSMSSSMMMSMSAAXSSSXSMXAMXSXMX
MSMSMMXSMSMMAXMASAMSAMXMASAAMXSAAXAMXSMSSSSSXSAXXXXAMMSMXXSXMASAXXMASAMXMSXXAAAASAXMAMMMMMMMMSAMMAMXMMXSMXMSAMAAAAXXMAXMXMSMMSAMAAMXSAMXXASM
AMAMAXAMXXXSXMXAXMXMASAMXMMMSMSXSMMSAMXXAXAAXAXMASMSMSMXXXAMMMMMMSMXSMMSAMXMSMSMSMSSMMMASXSSMMXSMAXMASAMXXXMMMMMMXMMSMMSAMXASMAMMSMMAAXXMASM
XMAMMMXSAMASMAMXSXXSAMAMSMMAAASMXXMAAASMXMMMMMXXXAAAMAMMMXMAAMAMAMXASAAAAMAAAAAMXMMASXSXMAMAAMAMXSXSAMXMAMXSXAMSMSAMAXAXAMAMMSSMXMXAXXMSAMXM
SMXSAAAMAMAMMSMAXAMMXSAMAAXSMXXASXSMSMAMXAAXMXMMMMSMMAMSAAXSXSAMAMXXSMMSASXSMSMSAMSAMMSAMXMSAMXSAXMMXMAXAMAAMAMAAAXSASMSSMXSAAXMASASAMXSAASM
AAAAMMSSXMASAAMSXSAMXSXSXSMXMASASAMXMAASASXMXAAXAXAASAXASXMMASXSASMMMXAXXMAAMXXXMMMXMAMAMXMXAMXSAXAXSXMXAMMXSAMMSMMMMSMAMXMMMSSMXAAXAAAMXMXM
MMMSAAXMMMSMMSSMAMMMMMMMMXAXSXSAMXMAXXXSXAAMSSSXMXSXMXSMMSAMAMAMXSAAAMXMAMMMMMSMSXSMMMXMMAXSAMAMASMXMASXSMMASXSAMXSAMXMAMAXASXXMMMMMMMXMMSSM
SAMAMMSMSMXAMMXMAMMSASASASAMMAMMMMMXMSAMXMXMAAMASMMXSMAXAXMMMMSMMMXSMSSSSSMAAAMMSAMMAMASXSMSAMXSASAXMAMAMAMMSAMXSASASXSMSMSXSXAMAAAAXSASAAXX
SMSMXXAAAAMMMMASASASASXMASAMXMAXAXSXMAAXMSXMAMXAMAMAMXSMMSXSXAAMXSMXXAAMAAMSMMSAMXMMASMSAMXSAMXMASXMMMSASAMAMXMAMASAMMSMAAXMMMSSSSSSSMAMMMMX
XAAXASMSMSMAAXXXAXMMMMAMAMAMXXSSMXXMAMXMAMASXSMMMAMAMMXXAAAXMSXSAMAAMMSMSSMMMAMXSAMSASAMXMASXMAMMMMAXMAXXMSAMXMAMXMAMAMMMXMSXAAMAAAXAMXMSASA
MXMXAMXAXMMSXSMMSMSSSSMMSSXMXXXAMXXSSSSMXSAMAMAAXSMMMAAMSMXXMAMMASASMAXMAAAAMMSASAXMSMXMXMASMXXXAAXMAMMAXMSXSASXSXSAMSSMSMASMMMSAMMMSXMXXASA
SASXSSSXMSXMAAAAXAAAXMASXMAAXXMSAMMAAAXAAMASAMMMAMASMSXAXXAXMSSSXMAXMXSMSSMMSMAXMMMXAMXXMXAXMASMSMXSAASMXAXXSAMSAASXMAAAXMAXXAASMAMAXAXXMMMM
SASAXAMXASAXSSSMMMMMMXMSASXMXMAXAXMMMMMMMMXAXXAMXXAMAMXSAMAMSAAXMMMMSXSAAXMASMMMMMXMMAMMAMSSMAXAAAASAMAAMSMXMSMMMMMMASMMXMMSMXMSSSMASMMAAAAA
MSMXMAMSSMMMXAAAXXMASMXSAMSAMXSMSMMASAAXMXAAMMXXSMSSXMXXASAMXMSMSAMXMAMMMMMMMMAAAAAAXMMAXXMMMMMSMMMSAXMMMMAXAXXAAAXXAXAMXAAAXMMMMMMAMMSXSMSS
SAMXSMMXXAAAMMMSAMXSMAAMAMMMXMXXAAMASXSXMSXSXSXASAMXAMXSXMAMMXMASASXMMMSXXSMMSSSSSSSSMSSSMXSAXXMAXAXXMXSAXMMMXSSSXMMSXMMSMSSSXSAAAMMXMXMMMXM
XAMMASMSSMMSMAAXXAXMXMMSMMASASXASXMASAMXXSAMAAMMMAMSAMAXMASXMAMMMAMXAMSMSXAAMXAAAAMAAAAAAAAMXXMXMMSSMSASMMXAXAXMAXSAMAMXSAMAAMASXMXMAMMSAXAM
SSMMSAMXAASMXMMSMMMSAMXXXSASASAXAAMAMAMMMMAMMXSASAMMAMXXXAXAMMSMSSSMSMSAXSSMMMMMMXMMMMMSMMMXMMAASAMAAMASAASXMMXMXXMAMXMMSAMMMMXASXSSXSASASMS
XAXSMMSSSMMXAMAAAAXMMSSMAXXMXMXSSXMXMAMAAMXMXASASASMSMXSAMXMMSAMMAAAXAMXMMMSMXSAMXSAAXXAMXSAASMMSAMMMMMMMMAAMAMSASMSMASASAMSMXSAMXAAAAXMAMAA
MXMXAAXMMMMSSMSSSSSMASAMSSMXXSAXAMMSSXSSSMSMMXMAMAMMXSAMXSAMXSASMSMMMSMMXMXAMXSAMXSSMMAMXAMMMMSASXMASMXSSMSSMASMASAXSMMASXMXMMAASMMMMMMMAMAM
MXXMMMSMXSAAAAAXAXAMMXAMAAAAMXXSAAAAXXMAMAXXMXMMMSMMXMXSASASASAMXXXAAXAMASAXMASXMMMMSMAXMMSXXAMMMMSAXSAMXAMXMMSMMMMXAXMAMXMASASMMAXSXSAMAXAX
MSMXAXXAAMMSMMMMSMSMMSMMXSMSXSMSXMMSMSMAMSMSMXMXMMAAMMXMASMMASAMXXSMXSXMAXAASASASXAAXXXMASAMMSMXMXMXSMXMMAMMMMXXXXXSMMMMSSXXAMMASMXAAMAMSMMS
AAASXMMMMSMAXXXAAMAAXSXSMXAMAAASAXMAXAAXMXAMXAXAMMXMAXAMMMMMAXAXMMXMXSAMASXXMASAMSMMAXMAMXASAMMSMAXMMMSASAMAAAAMXMXAXXXSAMMMMASAMXSMSMSMMAMX
SAXMSAAAAAMMMSMSSSMSMMAMAMAMXMSSMMMXASAMXMAMSMSXSSMSXMAXAAXMSSMMXMMSASMMMXXAMAMAMXMAXMASMSAMASASXSXSAAMXSAMSAMXAAAMMSMXMASAXSMMAMXAAMAXAMAMX
AMMASXMMSSSMASAMAAXXAMAMMSMMXXXXAAMXMMXXXMMMMAAAXMAXMASMSXSXAAXMAXSMAXXAXMSMMMSXMSMXMAXAMMMMAMXMAMAMMMSASMMXAXMSMSAMAMMSAMMXSAMAMXMSMMMSSSMM
SSMAMAMAMAAMAMAMXMMSAMXMXAAMAMMSSMSMXSXXMAXAMMMSMMSMXXMAXMSMSSMSXXAMSMSMSAMASAMXAAMSSSMSMAXAAXAMSMSMSXMASASMSMMAAXAMAMAMAMXMSAMXMMAMXXAAAAXX
MAMXSXMAMSMMXSXMASAMSMASMSSSMXAAXSAMAXMSSXSAMAAAAMMMSAMXMAXAXAMAXMXMXAMASXSAMASXMXSAAXAXSASMMSXSXAMAMXMXMXMAMMSASXSMSASMSMSXSMMAMMSMMMSSSMAA
SMMXMASAXMXMASASMSXSASMSAAAAMMMMSMMMMSMMAXAMSSSSXMAASXXMMAASMMMAXSAMMXMAMMMMSAMXMMMMSMMMMMSAASMMMSMAMSASMAMSMASAMAMAMAMAXXAAMXMSMMXAXMAAAXXM
XAMXXXASAMAMXSAMASMAMMXMXMMMMASXMMXSAAAMMAMMAXMMMSMAXMAXASMXAMMAXSASMSMASXSASAMMAAXAMMXAXASMMMAAAXXAMXAXMAMAMXMSMXMXMAMSMMMSMMMXAASAMAMSMMMM
SSMMSMAXXSXSAMAMAMAAXMAMXSMMSASMSMAMSSSMXMXMMSXAAXXAASMMMMASMMMXMSAMAAMXSXSAMAMXAMSASASASAMSXSSMSSSMMMAMSSSXSAAXMMMMSXMASXAXXXASMMMAAMXXXAAM
AAAAXAMSASAMXSXMXSSSSSMMAAAXMAXAAMXMXXMAXXSMXAMMMSASAMAAAMMMMAXMXMXSSMSSMMMMSAMXAXMASAMAMMXMMAXMAMXAAMAAAAAXSMXMMAAXMMAMAMASAMXMAASXMXASXSSS
SSMXXSAMMMAMASMMMAAAAAAMSSMMMAMSMSMMSAMAXMMAXAXAAXXMASXMSAMXSASMMSAMXMXXAAAMSMSMSXSXMAMXMSASAMMMXSSSXSMMMXXMXMASMSMSAMSXMXAMXXASMMMMSAMXAMXX
XAMXAXXMXSSMAXAMAMMMSMMXMAMMMMMXAMAMSAMASMMSMSMMMSAMAMXAMMMAMAMMAMXSAXASMMMXMXXXMAXXMXMXASAMMSAAXAAAAXXXMXSXXSXSAXASMMAMXSAMXMXXSAAAAASMXMAX
MAMSMMAAXAXMMSXXAMXXXMSMSSMAXMAMAXSMSAMMXMAAAXXAAXAMASMSMASXSASMSMAAMMMMSSMSXXAMXMXSMMSMMMXMASXSAMXMMXXAAAMAMMMMMMXMASMSAAAMAMSXSSMSSSSMSMMM
SMXAMSSMMMXXXAMMMMXXMXXAAAXXSMSMMMMAMMSSMMSMSMMMSSSSMMMXSAMXMASXXXMXSMSXXXXAAASAMMASAASAXMMMASXMAAXAMXMMMXSMXAAAMAMXAXXMASXMAXAMXAMMXAMAAAAX
AAMMXAAXMXASMMMXAXXMSMMMMSMMAAAAXSMSMAAAMAASXXAMXAMXMMXMMMSMMXMAXAMXAAXMMMMMSMMASMAMMMSSMXAMXSASXMSMMMXSAAAXSMSSSMSMMSMMMXMSSXSASXMSAMXMSSMM
MAAXMMSMMMMSAAASMMMAAAAAAMAXMSMXMXAXMMSAMSMMMMSSMMMSMSAAMASASASMSAMAMAMXAAAAAMSAMMSSMXXAXSSSSSMMMMAMMAAXXMMMXAAAAAMXXAAAXAMAXAMXMAMMMXAXXAMS
XSSXMXXMAAAMMMMMAAXSSSMMSSSMXXXMMMAMXXXMXMAASAAXASXMAAXXMXSASASMMAXXMAXMSXSSXMMAXSAAASMMMAAMMMAAXXASMMSSXMXSSSMSMMASMSSMSASAMMMASXMAXMXMSAXA
MXMAMMXSSSSSSMSSSMMMAAXAXXXAXMAASXSMSAMMAMAMMASXMMAMXMSXMXMXMAMAMSMXMXMXAAMAMSMMSMMMMXAXXMMMAMMMXSAMXAMXMMMAAXXXASAXMAAAXAMASXSMMMSSXSAMSXMM
XASAMXAMAAMAAAMAXMAXMAMXSSSSMMSMSAMAXAAMSSMMSSMMMSAMAMMASXXMMXMAMAASMAMMMMMAMXAXXAMASXSMMMXSMSXAXMAMXMASAAMMSMMSMMASMSMXSASXMASAMXXAASAMMMAX
SMSMSMAMSMMSMMMAMSMXSSSMAMMMMXMAMAMMSSMMAAAXXAAXASASAASAMAMASASMSXXAMXSSSXMAMMMMMSSXMAMSASAMSAMXSSXMAMAXMXSAAAXSXSMMAAAMSAMXMSXMASMMMXAMXAMM
AXXAXMXMAAXMMXMAMXSMAMAXMSAMXASXMSMXAMSSSSMMMXMMXMASMXMXAAMSSXSXXMMMSXAAAXSASXSASMMMMAMAXMASMXMXXMMSMMSSMXMMXAXMASXMXMSMMAMXXMAXAXXXMSMMXSXA
MMSMMMXXMXMMXAXXXAXMASAMXSAMXAMAMMMMMSAMXAXXAASXSMASMXXASMMXMMMMMSAAMMMMMMXASAAMSAAMSASMXSSMMASXMAAAXAAAMASMMSMMAMAMXAAAXMMSMSAMSSSXMAASAMMS
XAAAAXMSSMSSSMSAMXSXXMAMASASMXSAMAXAXMASXMMXSASAAMAMXMAMXMSMSAMXASMSMAXMASMMMMMMXMAXSXXAMXAASAXMAMSSSSMSMASXXAAMXSAMAMAMSMMAAMMXXAXASXMMASAM
MSSSMSAAAAAAAXAMXMAXXMSMASMMMAMAXAMSSSMMAAAMMAMXMMSXSASMAXAXSXXAXXMMXXSXAXSMASXAXAXASXSMSSSMMXXSSMXMAMXAMXSXSAXSAAAMXSAMAASMSMSAMMSMMMMSSMMA
XXAXAXXSMMMSMMMXSMSXSAAMAMASMMSMMSSMAMXSSMSSMAMMSAMAAAXMMMMXMSXSMXSASMSXXMMMAXMMMMMMMASAAAAMSXXAAMXMAMSSSMSAASMMXSXMASASMXMAMAXXMMAMAMXXAAAX
MMMMMMAXAAXAXMMAXAXMXAMMMSAMAAAAXMAXXMXXAAAXMASXMMSXMXMASXMAAMMMMAMASAXMXAMMMSAASAAAMAMMMMMSAMXSMMAXAMAMXAMSMAXXXMMMXMAMXMMXMXMXMAXSASMSMSMX
MASMSXSXXMMXMMMSSMSSMSXAXMAXMMMXMSAMXMXSMMMSSXSMMXMXMXSMMASMXSAASXMAMMMAXXAMXAXASMSXMASAAAXMXSMAXSSSMSAXMXMXSMMSAMAMMMXMSSSMSAAXXMASASAAXAMA
SASXSAXAASXMSAAAAAAXAMMMSSSXSMMSAMXSAMXAXXXMAXSMSASAMXSXSAXMASMXSMSASXSSSXSASAMXMMMMSXSMMMSAASAMXXAAASAMMSMAMXMXMSASASAAAAAASXMMMXAMXMXMMAAM
MMSMMAMSXSAAXMSSMMMMSMAMMAMXAAXMASASASMMSXSSMXSASMSAXASAMAAMAMMMSASASAAXMAMAMXXMSASMSXMAMSAMXSAXMMSMMMASMAMASASMXSASAMMXMSMMMAXXAASMMSASXSMX
MASAMAMXAMMMMMMXXAXAAMAXMAMSMMMMMXMXAMXXMMMAMMMAMAMMMASXMSMMSXSASMMAMMMXMAMAMXSXMASAXMMXMXASASMMAMAXXMAMXMSXSASAAMAMAMMSAMXXMMMMMMMAASASAMXM
MAXXMAMMXMMASMMSMSMMMXMMMMMSMXMASMSMMMSMMASMMAMAMAAAMXMAMXMMMAMASAMSMAXMSASMSASMMMMAMXXMASAMXXXAXXMSMMSSMXSMMAMMSMSMXMASMMMMMSASXAMMMSMSMXAX
MMSASMSMSASMMAAMXMASMMMAMXAXAASMXAXAAAAAXMSXSXSMSMSXSAMMMMMAMAMAMAXMMSAMXAXAMASXAMAXXXMXMASMXMMSSMMAXSMAMAMAMXMXXAMXSAXMASAAMXASMXSAMXMMXSMS
MSAMAAXAMASAXMMSASMMAASXMMSSSMSAMSSSMSMSMAMASAAXXAAMSMSAXAXASAMASXMAAMAMMMMSMMMXMXXMASAMXMMSXMAAAASMSMSAMXSAMAMMMMMAMAMXAXMMSMSMXMSMSAMAXAAA
MAMXMMMXMASAMMXSMSAMSMMASXMAXAMMMXAMMAAMXSMAMMSMMMMXXMSXSMSMSXSASMSMMSMASAAXAXSASAMMMSAMAMSAXMASMMMXXMSMSXSMSXMAXXMASASMMSSMSXMAAXXAXXMASMMM
MSXMAXMXMASMMSAMXSXMMXSAMAMMMMMMXMAMMMSMAMMXMXMAXXMXMXXMXXAMXAMASASAXXMASMMMAMSASASAAMMXAMAAMMXXAAMASXMMSXXMAASASASASXMAXXMAXAXSMSMMMASXSMAX
MMASMSMAMXSAAMXMAXAMMAMAMAMAAXAXAXSMSXMMXMSSMXSSMMSMMSAASMSXMXMAMASAMMSXMASXSMMMMAXMSMASMSMSSXAMSMMASAAASAMXSXMASAMASASXMMMSMMMXXXXXMASAMASX
ASAMAMXSMMSMSMAMXMSMMAXAMXSSSSSSMXMAXAXMXXAAXXXMAXAAXAMXMAXSAXAXSMMMMAXAMAMMXAXAMAMSAMXSAAXAMMSMXAMXSXMMSXMMMMMXMAMXMXAMXXAXAXMMSMSSMMMAMAMA
AMAMMMAXXAXAAXXMSAXASXMASAAAAXMAXAMAMSMSSMSMMSMXMSSSMXSXMAMAMMMXMAAXMXXMMASXSSMMMMMSASAMMMMMSAXASXMXMAXXXASAAAXASAMXSXSMSMMSXSSXMMAXAXSAMXXX
ASXMXMAXASMXMSXAMXXMASAAMMMMMXSMMXSXSAAAXXAAXASAAXAAMXSAMASMXAXXSMMSXXSASASMAMMXSMASMMMSAXXMXAMXMASAMAMSSMMSMSMMXAXXMAMAAAMMAXAAXMMSSMSXSXSM
AMXXAMASMXSMAMMXMMMSASMMMXSXMASAMASXSMMMSMSXSASMSMMMMAXMMASXSMSASAXMAMXAMASMAMSAXMASAAASMMMSMSXSXMMXMXMMAMAMXAASMMMAMAMXMSASXMSMMAMAXAXAXMAS
MXSMMSAAMAXMXMAAAAAMASMXXAMAMXMAMASASXMMSAAMMMMMAAASMMSXMASMMAAASXAMAMMMMXMMXMMXMAAXMMMSMXAXAMMMASXMASXSXMASMSMMASMXMMSAAXMMAMXMSXASMMMSMMAX
SAXMAMXMMXSASXMSSMXMAMXMMSSMMXXAMASXSAMAMMMSAXAXMSMSAMXMMXMAXXMXMMMXXSXMAXMASXSXSMMSAMXMXSSMMMASAMAXMSAMXSXSAASMAMMAXASMSSSSMMAASAMXAXMASMAS
MMSSMSMSMSAMXSXAMASMMMMXAAAAAXSMMXMASAMAXAXMASMSXXXMAMXAXSXSMSSXSAMSAMXAMXSASMMAAAAXMASAAXMAXSASMSXMXSAMXMASMMXMMAXAMXXAXAASXXXXSASXMMMXXMAS
MAAAXMXAXSMXAMMSMAAAAXMMMSSMMMXAAXMASXMASMSMAAMAMMSSSMMMMSAMAXMAMASMAMASXXMASAMSMMXSMAAMMSMAXMAXMXAAMSAMSMXMMSSMXAASXMASMMMMMSSMSAMMSAMMMXAS
MMSSMSSXMMXMMMAXMXSXMXXAAAXAXMSMMSMAMMMAXMAMXSMASMAAAAAXAMMMSMMSMMMXMXAXXAMAMXMAAXMXMMMAMAMXSMSMAMXSASAMXXMXMAAXSAMXASAXMXMSAAXXMASMSASXXMXX
SAAXMAMXXMAXASMMMAMAAASXSXSAXMAMAMMSSMMSMSAMSAMXSMMMSAMXSSMAXAAAAXAAMMSSSSMMSMXSXMAMXSSSXXSMSAMAMSAMXSXMMMAMMMSMASMSAMXXMAAMMMSXMAMASXSMMAXS
MASAMMSMMMASMAAAMASMMMMAAAAAXSAMAXAXAXAMXMMMXAMXSXMMMAMAMAMASMMSSMSSSXXMAMAMSXMAMAMAXMAMXAXAMXMAXXXSAXAXXASAAMAAMXMMASMMSXSASXXAMAMMSASAXMXA
XMMXXMAMSAAMXSSMMMSMMAMSMMMMMSAMXXSMMMXSAXAASXMAXXSASAMAXAMXSXAAXXAMAMMASMSMMMXAXSXSMMAMMSMMMXMXSMASMXSAASASMSXSXMSMAMMASXMAMMMXSXSXSASAMMSX
SXAXMSMAMXMSMMAXSAMXMAXMAXXMASAMSXMASAMXASAXMAMSMMSXSXMXASAMXMMSSMXXXAXXXAMXMAXXMXAAMMAMAMAASASAMMMMAAAMMXXAMXXMXAAMXMXAMAMMMAAMAXAAMAMXMASA
XMAXAAMSMSMSASAMMAXSXMASAMXMAMMAAASMMMMSASXSXMAMAMSXMASAMAASXMMAXXSMMSMMMSMMMSSXAMSMMSSMMSSMSASXXAXMMMSXXMMSAMXXAXMSMSMSSXMXSXSMMSMXMAMXMMSM
SSSMSXSXAMAMAMASMMMSAMXSMMMMXSSXMMMMAXAMAMAMAMASXMSASAMSASMMXXMAMXMMAAXAAXAXAAAMXMAXXAXAAXMAMMMMSMSMAAXMXXAAXASMMMXAAAAAMAMMMMXAASMXMMSMMAMM
MAAMMMMMAMAMMMXSAMXMAMMXMAAAMAMXSASXXMASAMXSXMXSXXXMMMXAMXMASMMSMMSASXSMMXAMSSXXSSMAMASMMSMXMAAXXXAXXXAXXXMMMMSASXSMSMSMSAMAAASMMSASXAAMSAMX
MMMMAAMAAMMMXSMMAMMSAMSASXMSAMXAMAXAMSXSXXXXXSAXMAXXSXSSMMMMSXAXAXMAXMSASMAMAMAXXAXMAMXAMAXSSSSSSSSXMSMSMMAXAAMMMAAMMXAMXASMSMMXMMAMMSAMSASX
SSSSXSMMSXSAASASMMMMASMASAAXMAMXMSXMMSAMXSMMAMMSMSAXMMSAAAAXMMASMMMXMMMAMSXMXSASXMMSMMSSMMMMAAAAMAAMXAMAAMXSMSSSMSMMSSXSXMMMMXMAAMAMAXMASAMM
AAAMMXAAAAMMMMAXXAXSMMMXMMMMMXMXSMAXAMAMAAAXAMXAAMMAAXSAMXMAMMMMXAXMAAMMXSMMXMAMXMAAAASAAAMMMMMMMMMMSASMSMAMXMAMMMSAXAAXMMMMSSMSSSMSMAXAMAMS
MMMMASMMMMMSXMXMSMMMSSSMXAAASAMMMSMMSXSMMSAMSSSMSASXXMMAMXSMXAAMSMSASXSSXSASAMAXMMSXSMMXSAMAXASMMMXAXAMMXMXXAMMMMASXSMSMSAAAAAMMAAXAXXMAMXMM
XAAMXSASXMAMAMXAAXAASMAMSSSMSASXAAMMXAXAMXAMAAXSXXSMAXMAXXMMSXXXAXAMXMXAXSMMXSSSMMXAMXSAXMMMXMXAAMMSSMSXMMMSMSAMMASAXAAAMSMMSSMMAMSASXMASMMS
SSXSASAMXMASAMMSMSMSXSXMAMXAXXMMMMSMMMMAMXMMMSMMXAMMAMMASMAAAMMSSSSMSASMMSXSAMMAMAMAMAMAXSASASXMMMXMAXAAXMAAAMMXMAXMMSMXMAXMMAMXAXAMXXSASAAA
MMMXXMMMMMMXAXAAXMXXXSMMXSMMMSSMXSAMAXXXMAMMXXMSMMMMMSXMAXAMMSAAXXXAMMAXAXXMAXXAMAMAMXMMMSAXASMXXMASXMSSMSSSSXMSMMMSAMXSMMSMSSMSMMSSMXMASMMM
AXAXSMSXAASXSMSXSAMXAMAXXMASXAAAMSASMSSMSXSMASAAAXXAAAAMAMXMAMMSMSMMMSMXMSSXXMSMSSMSMXASXMAMSMMMXSXSAMAXAXAAAAAAASAMASASAAXXAMMAMAAAAXMAMAAS
SMSSMAMMSXSAMAAAMMSMMMSMMMXMASMMMMAMAAMAMSMMAMXSSMSMSSSMSSSMAMXXMAXSASAMMAMMSMAAAXAAXSSMAMXMXAXMXMASAMASXMMMXXSMSMMSXMASMASMMMSAMMSMMMMMSSMM
XAXAMAMAMMMAMMMSSMXXAAXAASXMAXMXAMXMMMMAMXXMAMMXXAAAMAMXMAMXAMXMXAXMAMSAMASMASASAMMMMMAXMASMSSMXAAXSXMAMMMXXXMMXAMXSAMAMXXXAXASMSAMAXAXXAMAA
MMMMSXSXMAXXMMAMAMAMMXSXMXAMXMSSSSSMXASMSMMMXXAMMXMXMAMXMMMSMSAXMAXMXMASMAXXAXXMAAMMAXMAXAAAAMAMXSASAMSSMMSMXMSAMXASAMXSMSMSMMXMMASXMSAMXSXM
AAAXMMMXMXSAMMASMMSSSXSMSSSMSSXAAMAXSXSAMMSAMSMAXSSXSXMAMSXAMMXMMXXMMSMAMASMSMXMXMASMMXMXSSMMMSAAMASAMAAXAXXMASAXMAMSXMAAAXXMMSAMAMXSMXAMXMX
XSSSXSXAAASASMMXAMXAAAMAMAAAXXMMMMMMMAMXMAMXMAXXSAXMASMSMASMSSSSSMMSAMXSMAMAMXMMSAMSASMSAAAAAAXMMMAMXMMSMMXMXMMMSAMXXXXMMSXSAMSAMMSMAMSSMXAM
MXAMAXSXSMSAMMMMSSMXMMMAMSMMMSAAXAAAMMMAMAXXMXAXMMMAMMMAMXSMAXAAAAAMSMAMMSMMMSXAAMXMMMAMXXMMMSSXXMAMXMAMAMASAMAMAAMAMAXXAAAMAMMAMAAAMASAMSAM
AMAMXMMXMAMXMASAAAMAMXXXMAXMAXXASMSSSSSXSSSSSMSMSSSXXASAMSSMMSMSMMMSXMXSAXAAAXMXMXMSSMSMXSMSAMXXMXSSMMASAMAXASAMSAMXSSMMMMSMAXMAMSMMXMSAMXAM
MSAMXXXAMASMSMMMSMSASMSMSMSMASAMXAAAAXXXMAAXXXMAXAAMSASAXAXAMMXXMSMMAMMMXSAMXMXAMXAXXAAAXAXSAXSASAMMAMASAMMSASMMMAMMXMAXMAXMASMMMMSSSXMAMSMM
AMAMMMMXSMMAAXXMAMSASAAAAAAMASAMMXMMMMXMMMMMMXMAMMMMMASMMSXMMSXMMMSMAMAMAMMMMASMSSSXMSMSXMASXMXAMXSSSMASAMXAMXMASAMXASAMXSXMXXAXSXAXAAXAMAXS
SSSMMAXXXAMSMSMSSXMMMXSSMSMMAXAMXAXAMXMASXSMAASASAAXMXMXAMASAMASAMSSXSMSAAAAMMMAAAAMXMSMAMAXAMMSMXMAMMXSXMXAAXSMMAMSASAMSXXMMMMMSMMSMASXSSSX
MAMASMSMSMXMAXAAMAAMXXMAMXXMMSMSSSSMSAXSXMXMAMSASMSMSASXMMMMASAMXMXAMXASXSXSXXSMAXMAMMAXXMAXAXAAAASAMXMMASMMMMAXSAMMAMXMAMAMAASAMAXMXAXXAXXX
MAMAMAAAAXSMSMMMSSMMXXMAMMSMXAXMAMAASAMXMMMMAXMXMXMAXASAAMXMXMXSXMSAXMXMMMAMXMSXSASXMSASMMSSMMSSSMSASMXSAMXSAAMXMASMSMSMASXMXMMASXMMMSSMSMMA
SSXMMSMMMMSAAXAAMAMAASXMMMAMXSSMMMSMXXAXAMASMSMAMMMSMMMMXMMMSAMMMMSAMSMMAMAMMXMAXAAAMAXSAAXAMAMAAAMMMMAMXSASXSXMSXMAMASMMSXMSASXMMAASXAAAAXX
XAASAXXXXAMMMMMMXAMMXMAAASASMXAMSAXMAMXMXMAMMAXAMXAAMSAMXSAXMAMMAAMMMMASXMSSXAMSMMMMMMXSMMSMMSSSMMMAAMXMAMXMAMMAMAMXMMMAMSASAXAAXSSMSMMMASMM
MSMMAMMSMMSASASMSMSMMSMMMSASMMAMMMMMXSAAMMSSSXSXSMSSMMXSASMXXAMSSSMSSMAMXAASAXMXXXMSAMXXMXSAAAAMAXSSXXAXXXSAAMMXXAMAMASMMMXMMXSXXMAMMXSAMAAA
AMAMXMAAAMSASASXAXAAMAAAXMAMASAMXSAAAXXSXAAAMMXAXMAAAXMSASXSMSXMAMXAAMASMMMSSMMXMSMSASMASAMXMMSMSMAMMSXSAXSMMSSSSMSXSAMXSSSXXXMMMSSXMAMAMXSX
MMAMMMMXSASAMXMXSSMSSSSMMSAAAAASASMSXSAXMMMSMAMMMMSSMMAMSMAMAMSMAMMXXMXXMAMXAXXAMAMXMMAXMMSXXXXAAMAMMAMXMAXXAAAMAXAMMMMMAAASAMXAAAXXMMSMMXXM
MSAMASXAAAMSMXXAXAMAAMMAMXMMSMXMXXAAASASMSAAASXMXAAAXAMSAMXMAMAXMSMSASXASXSSMMSXMAXMMXXSXAAMMMMSMSSMMASXMSMSMSMSSMMSASAMXMMSMSMMMSSMXMAASASA
MSMSASAMMMMMMMMSSMMMSMSXSXXAMMXMXMMMMMAMAMSSMMAMMMSMMSMSMSAMMMMMSAASAMMMMMAAMMAXSSSMSMAMXMASAAXMMXMASAMXMAAXXMAXMAASASXSASXXMSASAMMMASMSMASX
XSMMASMXMAXAAAMXAXAXXMXAAXMASAMXAXAXXMSMSMAMAMSMMAMAXXAMAXXSAAXXMMMMSMAASXSMMMMXXAAAAMAMAMAMXSMMMASMMASXSMMMSMSMMMMXAMAXAMAXASAMASASXSMAMMMM
MMASAMXSSMSSSSSMSMMMXMMAMXXAXXMMXXASXXAAXMASMSMAMASXMMMMMMXMXXSAXSXMXSXSXMAXXXXXSSMMMSASMMXSAMAASASXSAMXSAMMMAXAMXSMMMXMAAMMMMXMXMASAMMMMSMA
MSAMXSXXAAAXMAMMXAAMXSAMXMXMSMSMSXMMMSMSSMMXXAXXMASXSAASASMAASMXMAMMASXXXSSMMMMMAXXXXSASAASXMSSMASXXMASAMMMAMAMAXSMSXAAXXXAAXSAMMXAMXMMSAAMS
AMXSMXMSXMXMSASMSSMSAASXMAXXAAAAMXSAMMMAAAXSSMSMXMXAASASAMMMMAMMSSMMASAMMXAMAAAMMSMMXMXMMMSAXXMASAXXSAMMSSXSXMSMMXMXSSSSSMMMXXASXMXSXMAMSSSX
MMAXMAMAXSAAAAAAAXAXMMAMASXSMXMXMXXAMSMMSSMAAXXMASMMMMMMMMAMXMAAAAAMAMAAAMMSSXSMXAMSMSMXSASXMXXXMASXMASMMAAXSMAMAAXAMXAAMAMSSSMMASXAMMXMXMAX
XXMASMMSAMMXMXMMMMMXXXXAXAXASXSSMXSAMSAXAXASXMASAMAMXXXAAMXMAXMASXMMSSMXSSXAAXXXSMSAAAASAXXAMMMSAMXMSAMXMMMMAMXMSXMASMMMMSMMAAASAMMXMSMSSMXS
SMSAXMAMXXXAXMXASASMMMMSMMSMMXAAAASAMSXMMXMMASAMSSXMSSMMSXMSASXMMXMAXAASMMMMSMMAXXSMXMSAMXMAMAXMAMAMXMSAXAASMMSXMAASMXSXXMXSMMXMASAAXXASAMMA
MAMXSMXMAXSXSASASASAMAAXMAAXXMMMMMXMMSMAXAMSMMASMSAAAMAAXAMMMMAAXAMMSAMMAXMXAAMMMMMSMSXAXMMMMSMSAMXXAXSMSSMSAAMASXMAAAXMMSAMXSXSXMMXSXMMAMAM
MMMMMMSMMMMAXXMXMXMASMSMMSSSMSSSMMSSMMAMAXMAASMMASMMMSMMSMMAAXMMMSMAMMMMXMSSSSMXMAAASMXSASAMXXASXXXXMXMMAXAXMASASMSSMMSXAMXSAMMMSMASMXSSSMSX
AXASAAXSAAMMMXMASASMAAXXAMAMXAAAAXAAAMMMAMSSMMMMAMXSXSAMAMSSMSAMAXMXMAXXSAMAMXAASMSXSMAXAXASAMXMASMMSASXXMSMXXMASAMXAMXMSMAMAMAXAXMAXAMAAAXA
XSMSMSMXSSSSXXSASXSAMAXMMXMSSMSMMMSSMSAMAMAXMAMMMSAMXSAXXXAMXAAMSMXAMSSMMXXAMXXAMAXMSMMSSMAMMMMMAMAAXAMXXXMMSMMMMAMSXMASAMASASMSMXXMMSMSMMAS
XXASMMMMAMAMSAMXSXSAXASXXSAAXMXXXAXAASMSMSSMSASAAMMMAXXMSMMSSMMMXAMXMMAMXSXMASMMMAXAXMXAAXSMSMSMAMMMMSMXMASAXMAASAMXMXMSASMXMAAXXMSAMXAAXMAM
MMMMMAAMAMAMASXXMASXMASAAMMMSMMXMMSMMMASAMAASMSMSSMMSSMAXAAAAAAMSSMMMSAMAMXMASASMSMMMMMSXMMAAXXXASAXXXAXXSMAMSSXSMMMSAMSXMASMMMSXXXAAMSMMMAS
MAMAMXXMXMSSMMSAMAMXSXMMMMMXMASXMXSXSMXMAMMMMAXMMMAAMAXMSMMXMMMXAAAXASXMAMAXAMAMAAMXAXMMMSMSMSASXSXSMSXSMMMSMAMXSASASAMXMMAMAAAAMSMMMMXAASAS
SASASMSMSMMAMAMMMSAAMXMAXAMSSXMXSAMXAMXAAMMXMSMMASMMSSMXXMSSSSSMMSSMMXXSMSMSXMXMAMMSMMMXAAAAXSASASMSASMMAAAXMAMXSAMMMMMAMMAXXXMASAAXSXXSMSAX
SASMSMSAAASAMMSXSAMXMASXSXSXMASAMASXSXSSMMXAXXAXASMMXMSAMXAAXAAMXMAAXMMMMAXXMSSXAXMMSMMMSSXMXMAMAMAMSMASMMSMSASAMAMASMSAMASMSSSSSXSMXMAXAMXM
MXMAXAMSMMMMXSAXAXSAAXXAAMSASAMXSAMXMAXAAMSXMMSMASXXAMMMXMASMSMMAXXMMMAAXXMXAXMAMSAAAMAMMXMSXMSMXMSMXMXSXAMASXMAMAMAXAAAXXMAAXXAMAXXAMAMAMXA
MAMMMMMAXMASMMMSMMSMSSMMMMSAMASMMMSASXSSMMSASAMMAMXSASAXXAAXAMXSASXMSSSMSASMSAMMMSMMXSASAAASAMXXXMMAMXASMXMMSASMMSSSMSMSMMSMMMMMMAMSMSSSMSXS
SXSAAXSASXXSASAMXMSAAMAAMMMXMAXMAMSAAAXMAXSAMASMASAMASMSXXMSAMXMMSAAMAAMSXXAMMMAAMASMSASMMMSAMASXSMASMMSAXSASXMASAAMAMXAAXMAXMAMMAMXAAAAASAM
SASMSMMSAMXSAMXSMXMMMSSMSXSSMSSSXMMXMAMMMMMAMAMXXSAMXMAXXXXSAMXSXSMMMMMMXXMSMSSMSSXMMMAMXMMSAMXXAXSMMXXMMMMASXSSMMSMSMSSSMSMMASXSMSMMMSMMMSM
"""
from typing import Iterator
from itertools import zip_longest, islice
from collections import defaultdict


class WordSearch:
    def __init__(self, longString) -> None:
        self._lines = [line for line in longString.splitlines() if line.strip()]
        self._height: int = len(self._lines)
        self._width: int = len(self._lines[0])
        self._points: Iterator[tuple[int, int]] = (
            (x, y) for x in range(self._width) for y in range(self._height)
        )
        amplitudes = [-1, 0, 1]
        self.all_vectors = [
            (i, j) for i in amplitudes for j in amplitudes if i != 0 or j != 0
        ]
        self.diagonalsOnly = [
            (i, j) for i in amplitudes for j in amplitudes if i != 0 and j != 0
        ]

    def get_word_count(self, word_to_match: str):
        strings = self.get_strings()
        return sum(
            1
            for word in strings
            if all(
                x == y
                for x, y in zip_longest(
                    islice((char for char, _, _ in word), len(word_to_match)),
                    iter(word_to_match),
                )
            )
        )

    def get_mas_list(self, word_to_match):
        strings_iterable = self.get_strings(all_vectors=False)
        matches = []

        for word in strings_iterable:
            word_triplet = []
            for char_and_coordinates in word:
                word_triplet.append(char_and_coordinates)
                if len(word_triplet) == len(word_to_match):
                    break

            if len(word_triplet) != len(word_to_match):
                continue

            chars = [char for char, _, _ in word_triplet]
            if chars == list(word_to_match):
                matches.append(word_triplet)

        return matches

    def count_xmas(self):
        mas_lists = self.get_mas_list("MAS")  # [["M", 1,2],[] []]
        middle_map = defaultdict(list)
        for triple in mas_lists:
            if len(triple) != 3:
                continue
            middle_char, middle_x, middle_y = triple[1]
            middle_map[(middle_x, middle_y)].append(triple)

        return sum(1 for v in middle_map.values() if len(v) >= 2)

    def get_strings(self, all_vectors=True) -> Iterator[Iterator[tuple[str, int, int]]]:
        vectors = self.all_vectors if all_vectors else self.diagonalsOnly
        return (
            self.get_string_with_vector((x, y), (i, j))
            for [x, y] in self._points
            for [i, j] in vectors
        )

    def get_string_with_vector(
        self, point: tuple[int, int], vector: tuple[int, int]
    ) -> Iterator[tuple[str, int, int]]:
        [tempy, tempx] = point
        [i, j] = vector
        while self.isInRange(tempx, tempy):
            yield self._lines[tempy][tempx], tempx, tempy
            tempx += i
            tempy += j

    def isInRange(self, x: int, y: int):
        return 0 <= x < self._width and 0 <= y < self._height


testCase3 = """
M.S
.A.
M.S"""
simpleCase = WordSearch(testCase3).count_xmas()

testCase1 = """
.M.S......
..A..MSMS.
.M.S.MAA..
..A.ASMSM.
.M.S.M....
..........
S.S.S.S.S.
.A.A.A.A..
M.M.M.M.M.
..........
"""


# testAnswer2 = WordSearch(testCase1).get_mas_list("MAS")
# answer = WordSearch(mainTestCase).get_word_count("XMAS")
# answer1 = WordSearch(testCase2).get_mas_cout("MAS")

# print("answer: ", answer)
MainAnswer = WordSearch(mainTestCase).count_xmas()
print("Main Test Case: ", MainAnswer)
providedExample = WordSearch(testCase1).count_xmas()
print("Provided Example: ", providedExample)
# print(testAnswer2)
# Answer #1: 2401s
# Answer #2: 1822s
print("simple Test Case: ", simpleCase)
